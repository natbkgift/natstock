# Runbook งานประจำวัน (ทีมปฏิบัติการ)

## ทุกเช้าก่อนเปิดขาย (ประมาณ 15 นาที)
1. เข้าระบบที่ `/admin/dashboard`
   - ตรวจป๊อปอัปแจ้งเตือนสต็อกต่ำ/ใกล้หมดอายุ
   - กด "ทำเครื่องหมายว่าอ่านแล้ว" สำหรับรายการที่จัดการเสร็จ
   - หากต้องการเลื่อน ให้กด "งดเตือนวันนี้" (ระบบจะ snooze เฉพาะผู้ใช้ปัจจุบัน)
2. เปิดหน้า **รายงาน ▸ ใกล้หมดอายุ**
   - ตั้งค่า `expiring_days` ตามนโยบาย (เช่น 30 วัน)
   - ดาวน์โหลด CSV เพื่อแนบในสรุปประจำวัน
3. เปิดหน้า **รายงาน ▸ สต็อกต่ำ**
   - ตรวจว่าจำนวน `qty_total` ≤ `reorder_point`
   - ดาวน์โหลด CSV และแนบให้ทีมจัดซื้อ

## ระหว่างวัน (ทุก 4 ชั่วโมง หรือเมื่อมีคำสั่งซื้อจำนวนมาก)
1. ตรวจหน้า **การเคลื่อนไหวสต็อก**
   - ดูรายการล่าสุดว่ามีการบันทึกรหัสล็อต (`batch_sub_sku`) ครบหรือไม่
   - กดปุ่มรีเฟรชเพื่อยืนยันว่าข้อมูลล่าสุดจากพนักงานถูกบันทึกแล้ว
2. เปิดหน้า **นำเข้าข้อมูลสินค้า**
   - ใช้โหมดพรีวิวเพื่อดู 20 แถวแรกของไฟล์ที่ทีมอัปโหลด
   - ถ้ามีแถวผิด ให้แจ้งทีมแก้ไขจาก `error.csv`

## ตรวจสอบ scheduler
- ที่เซิร์ฟเวอร์ รัน `php artisan schedule:run --verbose --once`
- ตรวจ timestamp ในรายงาน expiring/low-stock ว่าตรงกับรอบเช้า (เช็คใน footer หน้า preview)

## การสำรองข้อมูล (รอบเย็นทุกวัน)
1. รัน `php artisan inventory:backup`
2. ดาวน์โหลดไฟล์จากหน้า **Admin ▸ Backup**
3. เก็บสำเนาบนที่เก็บกลาง (S3/Nextcloud) และอัปเดต log ประจำวัน

## การจัดทำรายงานสรุปส่งผู้บริหาร
- แนบ CSV ใกล้หมดอายุ + สต็อกต่ำ พร้อมตัวเลขรวมยอดคงเหลือปัจจุบัน
- แจ้งสถานะ import ล่าสุด (STRICT/LENIENT) และมี error หรือไม่
- บันทึกหมายเหตุหากมีการ snooze แจ้งเตือนข้ามวัน
